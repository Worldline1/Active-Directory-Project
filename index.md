---
layout: default
---

# Introduction
![AD Diagram](AD-Diagram.png)
This project simulates a small enterprise network environment designed for cybersecurity monitoring and detection testing.

The lab consists of four virtual machines connected through a custom NAT network:
- **Ubuntu Server** running Splunk Enterprise (SIEM)
- **Windows Server 2022** configured as an Active Directory Domain Controller
- **Windows 10** endpoint joined to the domain
- **Kali Linux** used for attack simulation

The objective is to monitor and analyze security events generated by endpoint activity and attack scenarios. Logs are collected using **Sysmon** and forwarded to Splunk via the **Splunk Universal Forwarder**.

Attack simulations are performed using **Remote Desktop Protocol (RDP)** and **Atomic Red Team**, allowing for detection validation and identification of visibility gaps.

## 🖥️ Environments Used

- **Ubuntu Server 24.04.2** – Hosts Splunk Enterprise for log collection and analysis.

- **Windows Server 2022** – Configured as the Active Directory Domain Controller (AD DC), managing domain users and machines.

- **Windows 10 Pro** – Acts as the target endpoint, joined to the domain. Sysmon and Splunk Universal Forwarder are installed to collect and forward event logs to the Splunk server.  
  Atomic Red Team is also deployed on this machine to simulate adversarial behavior and test detection coverage.

- **Kali Linux** – Used as the attacker machine to simulate intrusions and generate activity on the target system.

All machines are connected through a custom NAT network, allowing isolated communication between them for testing.

## 🖥️ Configurations

| Machine        | Role                     | OS                     | IP Address         |
|----------------|--------------------------|------------------------|--------------------|
| Ubuntu Server  | Splunk Enterprise (SIEM) | Ubuntu Server 24.04.2 | 192.168.10.10      |
| Windows Server | Active Directory (DC)    | Windows Server 2022   | 192.168.10.7       |
| Windows 10     | Target PC                | Windows 10 Pro        | 192.168.10.100     |
| Kali Linux     | Attacker                 | Debian-based Linux    | 192.168.10.250     |

## ⚙️ Lab Setup

The virtual environment was created using [VirtualBox](https://www.virtualbox.org/), where four separate virtual machines were installed using official ISO images:

- **Windows 10 Pro** – [Download](https://www.microsoft.com/fr-fr/software-download/windows10)
- **Kali Linux** – [Download](https://www.kali.org/get-kali/#kali-platforms)
- **Windows Server 2022** – [Download](https://www.microsoft.com/fr-fr/evalcenter/download-windows-server-2022)
- **Ubuntu Server 24.04.2** – [Download](https://ubuntu.com/download/server)

After installation, a **custom NAT network** named `AD Project` was created using VirtualBox’s network management settings. The network uses the subnet `192.168.10.0/24`. All virtual machines were connected to this isolated NAT network to allow internal communication while remaining disconnected from the external internet.

This setup replicates a small enterprise environment for controlled simulation of attacks, event logging, and centralized analysis.

## ⚙️ Ubuntu Server Splunk Setup

After installing the Ubuntu Server VM, the first step is to assign a **static IP address** to prevent the server from receiving a different IP on every DHCP lease renewal. This ensures consistent connectivity within the lab network.

To verify the current IP address, run:

```bash
# bash
ip a
```
Ubuntu Server 24.04 uses Netplan for network configuration. The typical Netplan config file (/etc/netplan/00-installer-config.yaml) might not exist by default. If missing, create it manually:
```bash
# bash
sudo nano /etc/netplan/00-installer-config.yaml
```
Paste the following configuration to assign a static IP address (192.168.10.10/24) and set the default gateway and DNS:
```yaml
# 00-installer-config.yaml
# yaml
network:
  ethernets:
    enp0s3:
      dhcp4: no
      addresses: [192.168.10.10/24]   # Static IP address
      nameservers:
        addresses: [8.8.8.8]           # DNS server (Google DNS)
      routes:
        - to: default
          via: 192.168.10.1            # Default gateway
  version: 2
```
Save the file and apply the changes with:
```bash
# bash
sudo netplan apply
```
The server should now use the static IP 192.168.10.10 on the NAT network subnet. We can check using `ip a`

## 🟧 Splunk Enterprise Installation (Ubuntu Server)

To begin collecting and analyzing logs, Splunk Enterprise must be installed on the Ubuntu Server VM.

### 1. Download Splunk

From the host machine:

1. Navigate to [splunk.com](https://www.splunk.com) and sign in or create a new account.
2. Go to **Products → Free Trials and Downloads**
3. Select **Splunk Enterprise** and click **Get My Free Trial**
4. Choose the **Linux** platform and download the `.deb` package (Ubuntu is Debian-based)

Transfer the downloaded `.deb` file to the Ubuntu Server. One way to do this is by using VirtualBox’s **shared folder** functionality.

---

### 2. Optional: Set Up Shared Folder (for transferring Splunk installer)

> ⚠️ This step is optional and only needed if using a shared folder to move the `.deb` file. In a real-world server setup, files would be transferred via network protocols instead.

Install the VirtualBox Guest Additions ISO:

```bash
# bash
sudo apt-get install virtualbox-guest-additions-iso
```
In the VirtualBox menu:
Go to Devices → Shared Folders → Shared Folder Settings

1.  Click the blue icon with a green plus ➕
2.  Select the folder containing your Splunk .deb file
3.  Enable: ✅ Read-only, ✅ Auto-mount, ✅ Make permanent

Back in the terminal:
```
# bash
sudo apt-get install virtualbox-guest-utils
sudo reboot
```
After rebooting:
```
# bash
sudo adduser <your_username> vboxsf
mkdir share
sudo mount -t vboxsf -o uid=1000,gid=1000 <your-shared-folder-name> share/
cd share
```
3. Install Splunk

Navigate to the shared folder and run:
```
# bash
sudo dpkg -i splunk-*.deb
```
Then switch to the Splunk directory:
```
# bash
cd /opt/splunk
sudo -u splunk bash
cd bin
```
Start Splunk:
```
# bash
./splunk start
```
> Use Enter or Space to scroll through the license agreement
> 
> Accept with Y
> 
> Set the admin username and password when prompted (save these credentials)



